{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{517:function(a,s,t){\"use strict\";t.r(s);var e=t(50),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":a.$parent.slotKey}},[t(\"h1\",{attrs:{id:\"示例-dataset数据的的备份与恢复\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#示例-dataset数据的的备份与恢复\"}},[a._v(\"#\")]),a._v(\" 示例-Dataset数据的的备份与恢复\")]),a._v(\" \"),t(\"h2\",{attrs:{id:\"前提条件\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#前提条件\"}},[a._v(\"#\")]),a._v(\" 前提条件\")]),a._v(\" \"),t(\"p\",[a._v(\"在运行该示例之前，请参考 \"),t(\"RouterLink\",{attrs:{to:\"/zh/userguide/install.html\"}},[a._v(\"安装文档\")]),a._v(\" 完成安装，并检查Fluid各组件正常运行：\")],1),a._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[a._v(\"$ kubectl get pod -n fluid-system\\nNAME                                  READY   STATUS    RESTARTS   AGE\\nalluxioruntime-controller-5b64fdbbb-84pc6   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\"/1     Running   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          8h\\ncsi-nodeplugin-fluid-fwgjh                  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2\")]),a._v(\"/2     Running   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          8h\\ncsi-nodeplugin-fluid-ll8bq                  \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2\")]),a._v(\"/2     Running   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          8h\\ndataset-controller-5b7848dbbb-n44dj         \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\"/1     Running   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          8h\\n\")])])]),t(\"p\",[a._v(\"在部署Fluid时，可以通过修改charts中values.yaml中的workdir，配置Fluid工作目录\\n工作目录主要用于暂存备份过程中的一些中间文件，默认为/tmp目录：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-yaml extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[a._v(\"workdir\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\":\")]),a._v(\" /tmp\\n\")])])]),t(\"p\",[a._v(\"请保证Dataset已经进入Bound状态：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[a._v(\"$ kubectl get dataset\\nNAME    UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED PERCENTAGE   PHASE   AGE\\nhbase   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"443\")]),a._v(\".89MiB        \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\".00B    \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"4\")]),a._v(\".00GiB          \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0.0\")]),a._v(\"%                Bound   23m\\n\")])])]),t(\"h2\",{attrs:{id:\"备份\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#备份\"}},[a._v(\"#\")]),a._v(\" 备份\")]),a._v(\" \"),t(\"p\",[a._v(\"目前支持两种数据的备份：\")]),a._v(\" \"),t(\"ul\",[t(\"li\",[a._v(\"数据集的metadata，包括文件系统metadata（例如文件系统inode tree）等\")]),a._v(\" \"),t(\"li\",[a._v(\"数据集的一些关键统计信息，包括数据量大小和文件数量\")])]),a._v(\" \"),t(\"h3\",{attrs:{id:\"备份到pvc\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#备份到pvc\"}},[a._v(\"#\")]),a._v(\" 备份到PVC\")]),a._v(\" \"),t(\"p\",[a._v(\"首先创建DataBackup文件：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"cat\")]),a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<<\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"EOF\"),t(\"span\",{pre:!0,attrs:{class:\"token bash punctuation\"}},[a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" backup.yaml\")]),a._v(\"\\napiVersion: data.fluid.io/v1alpha1\\nkind: DataBackup\\nmetadata:\\n  name: hbase-backup\\nspec:\\n  dataset: hbase\\n  backupPath: pvc://<pvcName>/subpath1/subpath2/\\nEOF\")]),a._v(\"\\n\")])])]),t(\"p\",[a._v(\"用户需要将backPath中的pvcName设置为自己的PVC（需要有写的权限），将subpath设置为需要存储的子路径\")]),a._v(\" \"),t(\"p\",[a._v(\"创建后，会看到运行了一个backup Pod：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl get pods\\nNAME                   READY   STATUS        RESTARTS   AGE\\nhbase-databackup-pod   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\"/1     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          3s\\nhbase-fuse-krxlb       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\"/1     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          2m44s\\nhbase-fuse-mtdmc       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\"/1     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          2m44s\\nhbase-master-0         \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2\")]),a._v(\"/2     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          3m16s\\nhbase-worker-sqrzc     \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2\")]),a._v(\"/2     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          2m44s\\nhbase-worker-whmnv     \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2\")]),a._v(\"/2     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          2m44s\\n\")])])]),t(\"p\",[a._v(\"片刻后，该Pod变为Completed状态：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl get pods\\nNAME                   READY   STATUS        RESTARTS   AGE\\nhbase-databackup-pod   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"/1     Completed     \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          23s\\nhbase-fuse-krxlb       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\"/1     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          3m4s\\nhbase-fuse-mtdmc       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\"/1     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          3m4s\\nhbase-master-0         \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2\")]),a._v(\"/2     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          3m36s\\nhbase-worker-sqrzc     \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2\")]),a._v(\"/2     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          3m4s\\nhbase-worker-whmnv     \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2\")]),a._v(\"/2     Running       \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\"          3m4s\\n\")])])]),t(\"p\",[a._v(\"该DataBackup同样变为Complete状态：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl get databackup\\nNAME           DATASET   PHASE      PPATH                                NODENAME     AGE\\nhbase-backup   hbase     Complete   pvc://\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<\")]),a._v(\"pvcName\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\"/subpath1/subpath2/   NA           30s\\n\")])])]),t(\"p\",[a._v(\"进入该PVC，查看对应子目录，发现生成的两个备份文件：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"ls\")]),a._v(\" subpath1/subpath2/\\nhbase-default.yaml  metadata-backup-hbase-default.gz\\n\")])])]),t(\"p\",[a._v(\"其中，gz压缩包中是数据集的metadata，yaml文件中是数据集的一些关键统计信息\")]),a._v(\" \"),t(\"h3\",{attrs:{id:\"备份到本地\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#备份到本地\"}},[a._v(\"#\")]),a._v(\" 备份到本地\")]),a._v(\" \"),t(\"p\",[a._v(\"首先创建DataBackup文件：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"cat\")]),a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<<\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"EOF\"),t(\"span\",{pre:!0,attrs:{class:\"token bash punctuation\"}},[a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" backup.yaml\")]),a._v(\"\\napiVersion: data.fluid.io/v1alpha1\\nkind: DataBackup\\nmetadata:\\n  name: hbase-backup\\nspec:\\n  dataset: hbase\\n  backupPath: local:///data/subpath1/\\nEOF\")]),a._v(\"\\n\")])])]),t(\"p\",[a._v(\"用户需要将local://后的路径替换为需要保存备份文件的本地路径\")]),a._v(\" \"),t(\"p\",[a._v(\"片刻后，查看该DataBackup的状态：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl get databackup\\nNAME           DATASET   PHASE      \"),t(\"span\",{pre:!0,attrs:{class:\"token environment constant\"}},[a._v(\"PATH\")]),a._v(\"                      NODENAME                   AGE\\nhbase-backup   hbase     Complete   local:///data/subpath1/   cn-beijing.192.168.1.146   30s\\n\")])])]),t(\"p\",[a._v(\"发现该DataBackup变为Complete状态，同时会显示保存位置所在的路径和NodeName\")]),a._v(\" \"),t(\"p\",[a._v(\"查询NodeName对应的主机IP：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl describe node cn-beijing.192.168.1.146\\n\")])])]),t(\"p\",[a._v(\"获得IP地址后，就可以从主机的对应目录取走文件刚刚的两个文件\")]),a._v(\" \"),t(\"h3\",{attrs:{id:\"使用non-root身份进行备份\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#使用non-root身份进行备份\"}},[a._v(\"#\")]),a._v(\" 使用non-root身份进行备份\")]),a._v(\" \"),t(\"p\",[a._v(\"如果用户指定的数据备份目录只能以特定uid访问时，需要通过设置RunAs参数指定特定用户来进行备份\")]),a._v(\" \"),t(\"p\",[a._v(\"如果您已经参考 \"),t(\"RouterLink\",{attrs:{to:\"/zh/samples/nonroot_access.html\"}},[a._v(\"示例 - 使用Fluid访问非root用户的数据\")]),a._v(\" 为AlluxioRuntime配置了RunAs参数，默认进行备份的用户与启动缓存引擎的用户相同\")],1),a._v(\" \"),t(\"p\",[a._v(\"如果您没有为AlluxioRuntime配置RunAs参数，或者您希望以其他用户进行备份，可以通过为DataBackup配置RunAs参数进行设置\")]),a._v(\" \"),t(\"p\",[a._v(\"假如每台主机的/data/subpath1/目录都属于fluid-user-1用户\")]),a._v(\" \"),t(\"p\",[a._v(\"修改刚刚的DataBackup：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"cat\")]),a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<<\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"EOF\"),t(\"span\",{pre:!0,attrs:{class:\"token bash punctuation\"}},[a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" backup.yaml\")]),a._v(\"\\napiVersion: data.fluid.io/v1alpha1\\nkind: DataBackup\\nmetadata:\\n  name: hbase-backup\\nspec:\\n  dataset: hbase\\n  backupPath: local:///data/subpath1/\\n  runAs:\\n    uid: 1201\\n    gid: 1201\\n    user: fluid-user-1\\n    group: fluid-user-1\\nEOF\")]),a._v(\"\\n\")])])]),t(\"p\",[a._v(\"等待备份完成后，前往指定的备份位置，查看刚刚备份的文件：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"ls\")]),a._v(\" -al\\ntotal \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"217108\")]),a._v(\"\\ndrwxr-s--- \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"2\")]),a._v(\" fluid-user-1 fluid-user-1      \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"4096\")]),a._v(\" Mar \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"24\")]),a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"18\")]),a._v(\":34 \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[a._v(\".\")]),a._v(\"\\ndrwxr-sr-x \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"5\")]),a._v(\" root         root              \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"4096\")]),a._v(\" Mar \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"23\")]),a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"17\")]),a._v(\":02 \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[a._v(\"..\")]),a._v(\"\\n-rw-r--r-- \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\" fluid-user-1 fluid-user-1        \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"79\")]),a._v(\" Mar \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"24\")]),a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"18\")]),a._v(\":34 hbase-default.yaml\\n-rw-r--r-- \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"1\")]),a._v(\" fluid-user-1 fluid-user-1 \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"222303277\")]),a._v(\" Mar \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"24\")]),a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"18\")]),a._v(\":28 metadata-backup-hbase-default.gz\\n\")])])]),t(\"p\",[a._v(\"这表明我们以fluid-user-1的用户身份保存了备份文件\")]),a._v(\" \"),t(\"h2\",{attrs:{id:\"恢复\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#恢复\"}},[a._v(\"#\")]),a._v(\" 恢复\")]),a._v(\" \"),t(\"p\",[a._v(\"要进行恢复，需要保证Dataset的名称与原来保持一致，否则会找不到备份文件\")]),a._v(\" \"),t(\"h3\",{attrs:{id:\"从pvc恢复\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#从pvc恢复\"}},[a._v(\"#\")]),a._v(\" 从PVC恢复\")]),a._v(\" \"),t(\"p\",[a._v(\"在创建Dataset时，在spec中添加dataRestoreLocation，填入刚刚查询到的路径作为恢复路径\")]),a._v(\" \"),t(\"p\",[a._v(\"如果备份文件被移动过，需要修改路径\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"cat\")]),a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<<\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"EOF\"),t(\"span\",{pre:!0,attrs:{class:\"token bash punctuation\"}},[a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" dataset.yaml\")]),a._v(\"\\napiVersion: data.fluid.io/v1alpha1\\nkind: Dataset\\nmetadata:\\n  name: hbase\\nspec:\\n  dataRestoreLocation:\\n    path: pvc://pvc-local/subpath1/\\n  mounts:\\n    - mountPoint:  https://mirrors.tuna.tsinghua.edu.cn/apache/hbase/2.2.6/\\nEOF\")]),a._v(\"\\n\")])])]),t(\"p\",[a._v(\"创建Dataset资源对象：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl create -f dataset.yaml\\ndataset.data.fluid.io/hbase created\\n\")])])]),t(\"p\",[a._v(\"AlluxioRuntime资源对象无需做特殊配置：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ cat\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<<\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"EOF\"),t(\"span\",{pre:!0,attrs:{class:\"token bash punctuation\"}},[a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\"runtime.yaml\")]),a._v('\\napiVersion: data.fluid.io/v1alpha1\\nkind: AlluxioRuntime\\nmetadata:\\n  name: hbase\\nspec:\\n  replicas: 2\\n  tieredstore:\\n    levels:\\n      - mediumtype: MEM\\n        path: /dev/shm\\n        quota: 2Gi\\n        high: \"0.95\"\\n        low: \"0.7\"\\nEOF')]),a._v(\"\\n\")])])]),t(\"p\",[a._v(\"创建AlluxioRuntime资源对象：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl create -f runtime.yaml\\nalluxioruntime.data.fluid.io/hbase created\\n\")])])]),t(\"p\",[a._v(\"数据集加载时，将不再从UFS中加载metadata并统计UFS TOTAL SIZE等信息，而是从备份文件中恢复\")]),a._v(\" \"),t(\"p\",[a._v(\"片刻后，Dataset进入Bound状态：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl get dataset\\nNAME    UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED  PERCENTAGE   PHASE   AGE\\nhbase   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"443\")]),a._v(\".86MiB        \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\".00B    \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"4\")]),a._v(\".00GiB          \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0.0\")]),a._v(\"%                 Bound   20h\\n\")])])]),t(\"h3\",{attrs:{id:\"从本地恢复\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#从本地恢复\"}},[a._v(\"#\")]),a._v(\" 从本地恢复\")]),a._v(\" \"),t(\"p\",[a._v(\"在创建Dataset时，在spec中添加dataRestoreLocation，填入刚刚查询到的路径和备份文件所在主机的nodeName\")]),a._v(\" \"),t(\"p\",[a._v(\"如果备份文件被移动过，需要修改路径和nodeName\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[a._v(\"cat\")]),a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\"<<\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[a._v(\"EOF\"),t(\"span\",{pre:!0,attrs:{class:\"token bash punctuation\"}},[a._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[a._v(\">\")]),a._v(\" dataset.yaml\")]),a._v(\"\\napiVersion: data.fluid.io/v1alpha1\\nkind: Dataset\\nmetadata:\\n  name: hbase\\nspec:\\n  dataRestoreLocation:\\n    path: local:///data/subpath1/\\n    nodeName: cn-beijing.192.168.1.146\\n  mounts:\\n    - mountPoint:  https://mirrors.tuna.tsinghua.edu.cn/apache/hbase/2.2.6/\\nEOF\")]),a._v(\"\\n\")])])]),t(\"p\",[a._v(\"创建AlluxioRuntime资源对象：\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl create -f runtime.yaml\\nalluxioruntime.data.fluid.io/hbase created\\n\")])])]),t(\"p\",[a._v(\"片刻后，Dataset进入Bound状态\")]),a._v(\" \"),t(\"div\",{staticClass:\"language-bash extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[t(\"code\",[a._v(\"$ kubectl get dataset\\nNAME    UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED  PERCENTAGE   PHASE   AGE\\nhbase   \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"443\")]),a._v(\".86MiB        \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0\")]),a._v(\".00B    \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"4\")]),a._v(\".00GiB          \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[a._v(\"0.0\")]),a._v(\"%                 Bound   20h\\n\")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);","extractedComments":[]}