{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{523:function(t,a,e){\"use strict\";e.r(a);var s=e(50),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"示例-使用fluid加速主机目录\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#示例-使用fluid加速主机目录\"}},[t._v(\"#\")]),t._v(\" 示例 - 使用Fluid加速主机目录\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"测试场景-resnet50-模型训练\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#测试场景-resnet50-模型训练\"}},[t._v(\"#\")]),t._v(\" 测试场景：ResNet50 模型训练\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"测试机型： V100 x8\")]),t._v(\" \"),e(\"li\",[t._v(\"nfs地址：38037492dc-pol25.cn-shanghai.nas.aliyuncs.com\")])]),t._v(\" \"),e(\"h2\",{attrs:{id:\"配置\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#配置\"}},[t._v(\"#\")]),t._v(\" 配置\")]),t._v(\" \"),e(\"h3\",{attrs:{id:\"硬件配置\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#硬件配置\"}},[t._v(\"#\")]),t._v(\" 硬件配置\")]),t._v(\" \"),e(\"table\",[e(\"thead\",[e(\"tr\",[e(\"th\",[t._v(\"Cluster\")]),t._v(\" \"),e(\"th\",[t._v(\"Alibaba Cloud Kubernetes. v1.16.9-aliyun.1\")])])]),t._v(\" \"),e(\"tbody\",[e(\"tr\",[e(\"td\",[t._v(\"ECS实例\")]),t._v(\" \"),e(\"td\",[t._v(\"ECS   规格：ecs.gn6v-c10g1.20xlarge\"),e(\"br\"),t._v(\"    CPU：82核\")])]),t._v(\" \"),e(\"tr\",[e(\"td\",[t._v(\"分布式存储\")]),t._v(\" \"),e(\"td\",[t._v(\"容量型NAS\")])])])]),t._v(\" \"),e(\"h3\",{attrs:{id:\"软件配置\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#软件配置\"}},[t._v(\"#\")]),t._v(\" 软件配置\")]),t._v(\" \"),e(\"p\",[t._v(\"软件版本： 0.18.1-tf1.14.0-torch1.2.0-mxnet1.5.0-py3.6\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"前提条件\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#前提条件\"}},[t._v(\"#\")]),t._v(\" 前提条件\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[e(\"a\",{attrs:{href:\"https://github.com/fluid-cloudnative/fluid\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Fluid\"),e(\"OutboundLink\")],1),t._v(\" (version >= 0.3.0)\")]),t._v(\" \"),e(\"li\",[e(\"a\",{attrs:{href:\"https://github.com/kubeflow/arena\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Arena\"),e(\"OutboundLink\")],1),t._v(\"（version >= 0.4.0）\")]),t._v(\" \"),e(\"li\",[e(\"a\",{attrs:{href:\"https://github.com/horovod/horovod\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Horovod\"),e(\"OutboundLink\")],1),t._v(\" (version=0.18.1)\")]),t._v(\" \"),e(\"li\",[e(\"a\",{attrs:{href:\"https://github.com/tensorflow/benchmarks/tree/cnn_tf_v1.14_compatible\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"Benchmark\"),e(\"OutboundLink\")],1)])]),t._v(\" \"),e(\"h2\",{attrs:{id:\"已知约束\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#已知约束\"}},[t._v(\"#\")]),t._v(\" 已知约束\")]),t._v(\" \"),e(\"ul\",[e(\"li\",[t._v(\"通过主机目录实现挂载并不是推荐的使用方式，因为该方式依赖于Kubernetes意外的挂载点维护方式，实际上并不可靠，可能引发数据不一致的问题。\")])]),t._v(\" \"),e(\"h2\",{attrs:{id:\"数据准备\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#数据准备\"}},[t._v(\"#\")]),t._v(\" 数据准备\")]),t._v(\" \"),e(\"ol\",[e(\"li\",[t._v(\"下载数据集\")])]),t._v(\" \"),e(\"div\",{staticClass:\"language-bash extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[t._v(\"$ \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"wget\")]),t._v(\" http://imagenet-tar.oss-cn-shanghai.aliyuncs.com/imagenet.tar.gz\\n\")])])]),e(\"ol\",{attrs:{start:\"2\"}},[e(\"li\",[t._v(\"解压数据集\")])]),t._v(\" \"),e(\"div\",{staticClass:\"language-bash extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[e(\"code\",[t._v(\"$ \"),e(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"tar\")]),t._v(\" -I pigz -xvf imagenet.tar.gz\\n\")])])]),e(\"h2\",{attrs:{id:\"nfs-dawnbench测试\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#nfs-dawnbench测试\"}},[t._v(\"#\")]),t._v(\" NFS dawnbench测试\")]),t._v(\" \"),e(\"h3\",{attrs:{id:\"部署数据集\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#部署数据集\"}},[t._v(\"#\")]),t._v(\" 部署数据集\")]),t._v(\" \"),e(\"ol\",[e(\"li\",[e(\"p\",[t._v(\"在NFS Server中挂载数据集\")])]),t._v(\" \"),e(\"li\",[e(\"p\",[t._v(\"将NFS挂载到主机目录上\")])])]),t._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[t._v(\"$ sudo mount -t nfs -o vers=3,nolock,proto=tcp,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,noresvport <YOUR_NFS_SERVER>:<YOUR_PATH_TO_DATASET> /mnt/nfs-imagenet\\n\")])])]),e(\"ol\",{attrs:{start:\"3\"}},[e(\"li\",[t._v(\"查看NFS是否已成功挂载\")])]),t._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[t._v(\"$ mount | grep nfs\\n<YOUR_NFS_SERVER>:<YOUR_PATH_TO_DATASET> on /mnt/nfs-imagenet type nfs (rw,relatime,vers=3,rsize=1048576,wsize=1048576,namlen=255,hard,nolock,noresvport,proto=tcp,timeo=600,retrans=2,sec=sys,mountaddr=192.168.1.28,mountvers=3,mountport=2049,mountproto=tcp,local_lock=all,addr=192.168.1.28)\\n\")])])]),e(\"blockquote\",[e(\"p\",[e(\"strong\",[t._v(\"NOTE:\")])]),t._v(\" \"),e(\"p\",[t._v(\"修改上述命令中的\"),e(\"code\",[t._v(\"<YOUR_NFS_SERVER>\")]),t._v(\"和\"),e(\"code\",[t._v(\"<YOUR_PATH_TO_DATASET>\")]),t._v(\"为您的nfs server地址和挂载路径。\")])]),t._v(\" \"),e(\"h3\",{attrs:{id:\"dawnbench\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#dawnbench\"}},[t._v(\"#\")]),t._v(\" dawnbench\")]),t._v(\" \"),e(\"h4\",{attrs:{id:\"单机八卡\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#单机八卡\"}},[t._v(\"#\")]),t._v(\" 单机八卡\")]),t._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[t._v(\"arena submit mpijob \\\\\\n--name horovod-v2-nfs-hostpath-1x8-093000 \\\\\\n--gpus=8 \\\\\\n--workers=1 \\\\\\n--working-dir=/horovod-demo/tensorflow-demo/ \\\\\\n--data-dir /mnt/nfs-imagenet:/data \\\\\\n-e DATA_DIR=/data/imagenet \\\\\\n-e num_batch=1000 \\\\\\n-e datasets_num_private_threads=8 \\\\\\n--image=registry.cn-hangzhou.aliyuncs.com/tensorflow-samples/horovod-benchmark-dawnbench-v2:0.18.1-tf1.14.0-torch1.2.0-mxnet1.5.0-py3.6 \\\\\\n./launch-example.sh 1 8\\n\")])])]),e(\"h4\",{attrs:{id:\"四机八卡\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#四机八卡\"}},[t._v(\"#\")]),t._v(\" 四机八卡\")]),t._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[t._v(\"arena submit mpi \\\\\\n--name horovod-v2-nfs-hostpath-4x8-092921 \\\\\\n--gpus=8 \\\\\\n--workers=4 \\\\ \\n--working-dir=/horovod-demo/tensorflow-demo/ \\\\ \\n--data-dir /mnt/nfs-imagenet:/data \\\\\\n-e DATA_DIR=/data/imagenet \\\\\\n-e num_batch=1000 \\\\\\n-e datasets_num_private_threads=8 \\\\\\n--image=registry.cn-hangzhou.aliyuncs.com/tensorflow-samples/horovod-benchmark-dawnbench-v2:0.18.1-tf1.14.0-torch1.2.0-mxnet1.5.0-py3.6 \\\\\\n./launch-example.sh 4 8\\n\")])])]),e(\"h2\",{attrs:{id:\"fluid加速主机目录\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#fluid加速主机目录\"}},[t._v(\"#\")]),t._v(\" Fluid加速主机目录\")]),t._v(\" \"),e(\"h3\",{attrs:{id:\"部署数据集-2\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#部署数据集-2\"}},[t._v(\"#\")]),t._v(\" 部署数据集\")]),t._v(\" \"),e(\"ol\",[e(\"li\",[t._v(\"按照前述步骤完成NFS的挂载\")]),t._v(\" \"),e(\"li\",[t._v(\"部署Fluid加速NFS挂载的主机目录\")])]),t._v(\" \"),e(\"div\",{staticClass:\"language-yaml extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-yaml\"}},[e(\"code\",[t._v(\"$ cat <<EOF \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")]),t._v(\" dataset.yaml\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"apiVersion\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" data.fluid.io/v1alpha1\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"kind\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" Dataset\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"metadata\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n  \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"name\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" imagenet\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"spec\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n  \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"mounts\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n  \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"mountPoint\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" local\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"///mnt/nfs\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\"imagenet\\n    \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"name\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" imagenet\\n  \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"nodeAffinity\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n    \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"required\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n      \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"nodeSelectorTerms\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n        \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"matchExpressions\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n            \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"key\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" aliyun.accelerator/nvidia_name\\n              \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"operator\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" In\\n              \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"values\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n                \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" Tesla\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\"V100\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\"SXM2\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\"16GB\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"---\")]),t._v(\"\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"apiVersion\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" data.fluid.io/v1alpha1\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"kind\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" AlluxioRuntime\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"metadata\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n  \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"name\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" imagenet\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"spec\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n  \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"replicas\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"4\")]),t._v(\"\\n  \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"data\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n    \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"replicas\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),t._v(\"\\n  \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"tieredstore\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n    \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"levels\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\"\\n      \"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"-\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"mediumtype\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" MEM\\n        \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"path\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" /alluxio/ram \\n        \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"quota\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" 50Gi\\n        \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"high\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"0.99\"')]),t._v(\"\\n        \"),e(\"span\",{pre:!0,attrs:{class:\"token key atrule\"}},[t._v(\"low\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"0.8\"')]),t._v(\"\\nEOF\\n\")])])]),e(\"blockquote\",[e(\"p\",[e(\"strong\",[t._v(\"NOTE:\")])]),t._v(\" \"),e(\"ul\",[e(\"li\",[e(\"code\",[t._v(\"mounts.mountPoint\")]),t._v(\"通过\"),e(\"code\",[t._v(\"local://\")]),t._v(\"的前缀来指明要挂载的主机目录(e.g. \"),e(\"code\",[t._v(\"/mnt/nfs-imagenet\")]),t._v(\")\")]),t._v(\" \"),e(\"li\",[e(\"code\",[t._v(\"spec.replicas\")]),t._v(\"和dawnbench测试的worker数量保持一致。比如：单机八卡为1，四机八卡为4\")]),t._v(\" \"),e(\"li\",[e(\"code\",[t._v(\"nodeSelectorTerms\")]),t._v(\"作用是限制在有V100显卡的机器上部署数据集，此处应根据实验环境具体调节\")])])]),t._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[t._v(\"$ kubectl create -f dataset.yaml\\n\")])])]),e(\"ol\",{attrs:{start:\"3\"}},[e(\"li\",[t._v(\"检查部署情况\")])]),t._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[t._v(\"$ kubectl get pv,pvc\\nNAME                        CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM              STORAGECLASS   REASON   AGE\\npersistentvolume/imagenet   100Gi      RWX            Retain           Bound    default/imagenet                           3h28m\\n\\nNAME                             STATUS   VOLUME     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\\npersistentvolumeclaim/imagenet   Bound    imagenet   100Gi      RWX                           3h28m\\n\")])])]),e(\"h3\",{attrs:{id:\"dawnbench-2\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#dawnbench-2\"}},[t._v(\"#\")]),t._v(\" dawnbench\")]),t._v(\" \"),e(\"h4\",{attrs:{id:\"单机八卡-2\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#单机八卡-2\"}},[t._v(\"#\")]),t._v(\" 单机八卡\")]),t._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[t._v(\"arena submit mpi \\\\\\n--name horovod-v2-nfs-fluid-1x8-093009 \\\\\\n--gpus=8 \\\\\\n--workers=1 \\\\\\n--working-dir=/horovod-demo/tensorflow-demo/ \\\\\\n--data imagenet:/data \\\\\\n-e DATA_DIR=/data/imagenet/imagenet \\\\\\n-e num_batch=1000 \\\\\\n-e datasets_num_private_threads=8 \\\\\\n--image=registry.cn-hangzhou.aliyuncs.com/tensorflow-samples/horovod-benchmark-dawnbench-v2:0.18.1-tf1.14.0-torch1.2.0-mxnet1.5.0-py3.6 \\\\\\n./launch-example.sh 1 8\\n\")])])]),e(\"h4\",{attrs:{id:\"四机八卡-2\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#四机八卡-2\"}},[t._v(\"#\")]),t._v(\" 四机八卡\")]),t._v(\" \"),e(\"div\",{staticClass:\"language- extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[e(\"code\",[t._v(\"arena submit mpi \\\\\\n--name horovod-v2-nfs-fluid-4x8-092910 \\\\\\n--gpus=8 \\\\\\n--workers=4 \\\\\\n--working-dir=/horovod-demo/tensorflow-demo/ \\\\\\n--data imagenet:/data \\\\\\n-e DATA_DIR=/data/imagenet/imagenet \\\\\\n-e num_batch=1000 \\\\\\n-e datasets_num_private_threads=8 \\\\\\n--image=registry.cn-hangzhou.aliyuncs.com/tensorflow-samples/horovod-benchmark-dawnbench-v2:0.18.1-tf1.14.0-torch1.2.0-mxnet1.5.0-py3.6 \\\\\\n./launch-example.sh 4 8\\n\")])])]),e(\"h2\",{attrs:{id:\"experiment-results\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#experiment-results\"}},[t._v(\"#\")]),t._v(\" Experiment Results\")]),t._v(\" \"),e(\"h3\",{attrs:{id:\"horovod-1x8\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#horovod-1x8\"}},[t._v(\"#\")]),t._v(\" horovod-1x8\")]),t._v(\" \"),e(\"table\",[e(\"thead\",[e(\"tr\",[e(\"th\"),t._v(\" \"),e(\"th\",[t._v(\"nfs-hostpath\")]),t._v(\" \"),e(\"th\",[t._v(\"fluid (cold)\")]),t._v(\" \"),e(\"th\",[t._v(\"fluid (warm)\")])])]),t._v(\" \"),e(\"tbody\",[e(\"tr\",[e(\"td\",[t._v(\"Training time\")]),t._v(\" \"),e(\"td\",[t._v(\"4h20m36s\")]),t._v(\" \"),e(\"td\",[t._v(\"4h21m56s\")]),t._v(\" \"),e(\"td\",[t._v(\"4h2m16s\")])]),t._v(\" \"),e(\"tr\",[e(\"td\",[t._v(\"Speed at the 1000 step(images/second)\")]),t._v(\" \"),e(\"td\",[t._v(\"2426.4\")]),t._v(\" \"),e(\"td\",[t._v(\"2467.2\")]),t._v(\" \"),e(\"td\",[t._v(\"8959.7\")])]),t._v(\" \"),e(\"tr\",[e(\"td\",[t._v(\"Speed at the last step(images/second)\")]),t._v(\" \"),e(\"td\",[t._v(\"8218.1\")]),t._v(\" \"),e(\"td\",[t._v(\"8219.8\")]),t._v(\" \"),e(\"td\",[t._v(\"8275.8\")])]),t._v(\" \"),e(\"tr\",[e(\"td\",[t._v(\"steps\")]),t._v(\" \"),e(\"td\",[t._v(\"56300\")]),t._v(\" \"),e(\"td\",[t._v(\"56300\")]),t._v(\" \"),e(\"td\",[t._v(\"56300\")])]),t._v(\" \"),e(\"tr\",[e(\"td\",[t._v(\"Accuracy @ 5\")]),t._v(\" \"),e(\"td\",[t._v(\"0.9280\")]),t._v(\" \"),e(\"td\",[t._v(\"0.9288\")]),t._v(\" \"),e(\"td\",[t._v(\"0.9291\")])])])]),t._v(\" \"),e(\"h3\",{attrs:{id:\"horovod-4x8\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#horovod-4x8\"}},[t._v(\"#\")]),t._v(\" horovod-4x8\")]),t._v(\" \"),e(\"table\",[e(\"thead\",[e(\"tr\",[e(\"th\"),t._v(\" \"),e(\"th\",[t._v(\"nfs-hostpath\")]),t._v(\" \"),e(\"th\",[t._v(\"fluid (cold)\")]),t._v(\" \"),e(\"th\",[t._v(\"fluid (warm)\")])])]),t._v(\" \"),e(\"tbody\",[e(\"tr\",[e(\"td\",[t._v(\"Training time\")]),t._v(\" \"),e(\"td\",[t._v(\"2h9m21s\")]),t._v(\" \"),e(\"td\",[t._v(\"1h40m15s\")]),t._v(\" \"),e(\"td\",[t._v(\"1h29m55s\")])]),t._v(\" \"),e(\"tr\",[e(\"td\",[t._v(\"Speed at the 1000 step(images/second)\")]),t._v(\" \"),e(\"td\",[t._v(\"3219.2\")]),t._v(\" \"),e(\"td\",[t._v(\"11067.2\")]),t._v(\" \"),e(\"td\",[t._v(\"21951.3\")])]),t._v(\" \"),e(\"tr\",[e(\"td\",[t._v(\"Speed at the last step(images/second)\")]),t._v(\" \"),e(\"td\",[t._v(\"15855.7\")]),t._v(\" \"),e(\"td\",[t._v(\"20964.4\")]),t._v(\" \"),e(\"td\",[t._v(\"21869.8\")])]),t._v(\" \"),e(\"tr\",[e(\"td\",[t._v(\"steps\")]),t._v(\" \"),e(\"td\",[t._v(\"14070\")]),t._v(\" \"),e(\"td\",[t._v(\"14070\")]),t._v(\" \"),e(\"td\",[t._v(\"14070\")])]),t._v(\" \"),e(\"tr\",[e(\"td\",[t._v(\"Accuracy @ 5\")]),t._v(\" \"),e(\"td\",[t._v(\"0.9227\")]),t._v(\" \"),e(\"td\",[t._v(\"0.9232\")]),t._v(\" \"),e(\"td\",[t._v(\"0.9228\")])])])]),t._v(\" \"),e(\"h2\",{attrs:{id:\"结果分析\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#结果分析\"}},[t._v(\"#\")]),t._v(\" 结果分析\")]),t._v(\" \"),e(\"p\",[t._v(\"从测试结果来看，单机八卡通过Fluid加速效果并没有明显的效果，但是在四机八卡的场景下Fluid加速效果非常明显。\\n在热数据的场景下，可以缩短训练时间 \"),e(\"strong\",[t._v(\"(129-89)/129 = 31 %\")]),t._v(\"; 在冷数据场景下可以缩短训练时间 \"),e(\"strong\",[t._v(\"（129-100）/129 = 22 %\")]),t._v(\" 。\\n这是由于四机八卡下，NFS的带宽成为了瓶颈；而Fluid基于Alluxio提供了分布式缓存的P2P数据读取能力。\")])])}),[],!1,null,null,null);a.default=n.exports}}]);","extractedComments":[]}